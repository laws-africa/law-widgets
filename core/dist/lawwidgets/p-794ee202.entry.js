/*!
 * (C) Law Widgets https://laws.africa - GNU Lesser General Public License 3
 */
import{r as t,h as e,H as s,g as i}from"./p-201891dc.js";import{P as n,g as o}from"./p-ea1a9a1f.js";const a=class{constructor(e){t(this,e);this.expandIconHtml="";this.collapseIconHtml="";this.items=[];this.titleFilter="";this.expanded=true;this.frbrExpressionUri=undefined;this.fetch=false;this.partner=undefined;this.provider=n;this.filteredItems=null;this.innerItems=[]}parseItemsProp(t){if(typeof t==="string"){this.innerItems=JSON.parse(t)}else if(Array.isArray(t)){this.innerItems=[...t]}}refetch(){this.fetchContent()}async fetchContent(){this.ensurePartner();if(this.fetch&&this.frbrExpressionUri&&this.provider){const t=this.provider+"/p/"+this.partner+"/e/we/toc.json"+this.frbrExpressionUri;try{const e=await fetch(t);if(e.ok){this.innerItems=(await e.json()).toc}}catch(t){}}}ensurePartner(){if(!this.partner){this.partner=o()}}getSlotHTML(t){var e;const s=this.el.querySelector(t);if(s===null||s===void 0?void 0:s.querySelector(t)){return((e=s.querySelector(t))===null||e===void 0?void 0:e.innerHTML)||""}return(s===null||s===void 0?void 0:s.innerHTML)||""}componentWillLoad(){this.expandIconHtml=this.getSlotHTML("[slot='expand-icon']");this.collapseIconHtml=this.getSlotHTML("[slot='collapse-icon']");this.parseItemsProp(this.items);this.titleFilterChanged(this.titleFilter);this.fetchContent()}async expandAll(){Array.from(this.el.querySelectorAll("la-toc-item")).forEach((t=>{t.expanded=true}))}async collapseAll(){Array.from(this.el.querySelectorAll("la-toc-item")).forEach((t=>{t.expanded=false}))}titleFilterChanged(t){if(t){const e=t.toLocaleLowerCase().trim();const s=new Set;function i(t){for(const e of t.children||[]){s.add(e);i(e)}}function n(t){var o;let a=(((o=t.title)===null||o===void 0?void 0:o.toLocaleLowerCase())||"").includes(e);if(a){i(t)}else{if(t.children){for(const e of t.children){a=n(e)||a}}}if(a){s.add(t)}return a}for(const o of this.innerItems){n(o)}this.filteredItems=s}else{this.filteredItems=null}this.expandAll()}renderItem(t){const s=(t.children||[]).map((t=>this.renderItem(t)));const i=t.expanded===undefined?this.expanded:t.expanded;return e("la-toc-item",{item:t,filteredItems:this.filteredItems,expandIconHtml:this.expandIconHtml,collapseIconHtml:this.collapseIconHtml,expanded:i},s)}render(){return e(s,{key:"f8b5eaf0e2c359af4eea3b7d6ab3fcad94f393bb"},e("div",{key:"ddca6abce36c9be705a172c12e833a6f9d088b89",style:{display:"none"}},e("slot",{key:"6f55f20f2cb614bb7a7519c44a71f2f94ff60b14",name:"expand-icon"}),e("slot",{key:"9bc755de6658047c64c1c3f5e42a4b6342a883f8",name:"collapse-icon"})),this.innerItems.map((t=>this.renderItem(t))))}get el(){return i(this)}static get watchers(){return{items:["parseItemsProp"],provider:["refetch"],frbrExpressionUri:["refetch"],fetch:["refetch"],titleFilter:["titleFilterChanged"]}}};export{a as la_table_of_contents};
//# sourceMappingURL=p-794ee202.entry.js.map