{"version":3,"names":["akomaNtosoCss","LaAkomaNtosoStyle0","AkomaNtoso","PROVIDER","refetch","this","fetchContent","parseFrbrExpressionUri","newValue","ex","regExp","RegExp","output","exec","groups","Object","keys","forEach","key","_a","frbrCountry","frbrType","frbrSubtype","frbrAuthor","frbrDate","frbrNumber","frbrExpressionDate","replace","frbrLanguage","ensurePartner","fetch","frbrExpressionUri","provider","url","partner","resp","ok","el","innerHTML","text","error","getPartner","componentWillLoad"],"sources":["src/components/akoma-ntoso/akoma-ntoso.scss?tag=la-akoma-ntoso","src/components/akoma-ntoso/akoma-ntoso.tsx"],"sourcesContent":["@import url(\"https://fonts.googleapis.com/css?family=PT+Serif:400,400i,700,700i\");\n\n@import \"@lawsafrica/law-widget-styles/scss/mixins\";\n@import \"@lawsafrica/law-widget-styles/scss/variables\";\n@import \"@lawsafrica/law-widget-styles/scss/mixins/structure\";\n\nla-akoma-ntoso {\n  display: block;\n\n  &.flash-target {\n    @keyframes fadeout {\n      from {\n        background-color: yellow;\n      }\n      to {\n        background-color: unset;\n      }\n    }\n\n    :target {\n      animation: fadeout 2s;\n    }\n  }\n\n  // all AKN styling from law-widget-styles\n  @include law-widget-styles;\n\n  // traditions\n  &[frbr-country^=\"ke\"] {\n    @include tradition-ke;\n  }\n  &[frbr-country^=\"na\"] {\n    @include tradition-na;\n  }\n  &[frbr-country^=\"pl\"] {\n    @include tradition-pl;\n  }\n\n  // structural markup\n  &.show-structure,\n  &.show-structure-hier {\n    @include show-structure-hier;\n  }\n\n  &.show-structure,\n  &.show-structure-block {\n    @include show-structure-block;\n  }\n\n  &.show-structure,\n  &.show-structure-inline {\n    @include show-structure-inline;\n  }\n\n  &.show-structure,\n  &.show-structure-subflow {\n    @include show-structure-subflow;\n  }\n\n  &.show-structure,\n  &.show-structure-doc-container {\n    @include show-structure-doc-container;\n  }\n}\n","import { Component, Element, Prop, Watch } from '@stencil/core';\n\nimport { PROVIDER, getPartner } from '../../utils/services';\n\n@Component({\n  tag: 'la-akoma-ntoso',\n  styleUrl: 'akoma-ntoso.scss',\n})\nexport class AkomaNtoso {\n  /**\n   * Full Akoma Ntoso FRBR Expression URI used to populate the other `frbr` fields if they are unset.\n   * Setting this is the preferred mechanism for ensuring tradition-specific styling.\n   * */\n  @Prop({ reflect: true, mutable: true }) frbrExpressionUri?: string;\n  /**\n   * Country (a two-letter or code according to ISO 3166-1 [ISO3166] or a short and unique alphanumeric codes\n   * according to ISO 3166-2 [ISO3166-2]).\n   * */\n  @Prop({ reflect: true, mutable: true }) frbrCountry?: string;\n  /**\n   * Type of document\n   *\n   * - For legislation – Acts, Regulations, Statutory Instruments, and the like – use `act`.\n   *\n   * - For case law, use `judgment`.\n   *\n   * - For other documents – Policies, Memoranda of Understanding, Yearbooks, Press Releases, and the like – use `doc`.\n   * */\n  @Prop({ reflect: true, mutable: true }) frbrType?: string;\n  /** Subtype used if the document is anything other an `act` / `statement` / `judgment` / `doc` */\n  @Prop({ reflect: true, mutable: true }) frbrSubtype?: string;\n  /** The emanating actor, unless implicitly deducible by the document type (e.g., acts and bills do not usually\n   *  require actor, while ministerial decrees and European legislation do)\n   *  */\n  @Prop({ reflect: true, mutable: true }) frbrAuthor?: string;\n  /** Original creation date (expressed in `YYYY-MM-DD` format or just `YYYY` if the year is sufficient for\n   * identification purposes\n   * */\n  @Prop({ reflect: true, mutable: true }) frbrDate?: string;\n  /**\n   * Number or title or other disambiguating feature of the Work (when appropriate, otherwise optionally the string nn)\n   * */\n  @Prop({ reflect: true, mutable: true }) frbrNumber?: string;\n  /** Any content-specification date */\n  @Prop({ reflect: true, mutable: true }) frbrExpressionDate?: string;\n  /** The human language code in which the Expression is drafted */\n  @Prop({ reflect: true, mutable: true }) frbrLanguage?: string;\n\n  /** Fetch content from Laws.Africa services? Requires a Laws.Africa partnership and the frbrExpressionUri property to be set. */\n  @Prop({ reflect: true, mutable: true }) fetch = false;\n  /** Partner code to use when fetching content from Laws.Africa. Defaults to the `location.hostname`. */\n  @Prop({ reflect: true, mutable: true }) partner?: string;\n\n  /** Provider URL for fetching content (advanced usage only). */\n  @Prop() provider = PROVIDER;\n\n  @Element() el!: HTMLElement;\n\n  @Watch('provider')\n  @Watch('fetch')\n  refetch() {\n    this.fetchContent();\n  }\n\n  @Watch('frbrExpressionUri')\n  parseFrbrExpressionUri(newValue: string) {\n    /*eslint-disable */\n    const ex =\n      '^(/(?<prefix>akn))/(?<country>[a-z]{2})(-(?<locality>[^/]+))?/(?<doctype>[^/]+)(/(?<subtype>[^0-9][^/]*))?(/(?<actor>[^0-9][^/]*))?/(?<date>[0-9]{4}(-[0-9]{2}(-[0-9]{2})?)?)/(?<number>[^/]+)(/(((?<language>[a-z]{3})(?<expression_date>[@:][^/]*)?(/!?(?<expression_component>[^/]+?)?(/(?<expression_subcomponent>[^.]+))?)?(.(?<format>[a-z0-9]+))?)|!?(?<work_component>[^/]+)))?$';\n    const regExp = new RegExp(ex, 'g');\n    const output = regExp.exec(newValue);\n    if (output?.groups) {\n      Object.keys(output.groups).forEach((key) => {\n        if (output.groups?.[key]) {\n          switch (key) {\n            case 'country':\n              if (!this.frbrCountry) this.frbrCountry = output.groups[key];\n              break;\n            case 'doctype':\n              if (!this.frbrType) this.frbrType = output.groups[key];\n              break;\n            case 'subtype':\n              if (!this.frbrSubtype) this.frbrSubtype = output.groups[key];\n              break;\n            case 'actor':\n              if (!this.frbrAuthor) this.frbrAuthor = output.groups[key];\n              break;\n            case 'date':\n              if (!this.frbrDate) this.frbrDate = output.groups[key];\n              break;\n            case 'number':\n              if (!this.frbrNumber) this.frbrNumber = output.groups[key];\n              break;\n            case 'expression_date':\n              if (!this.frbrExpressionDate) {\n                this.frbrExpressionDate = output.groups[key].replace('@', '').replace(':', '');\n              }\n              break;\n            case 'language':\n              if (!this.frbrLanguage) this.frbrLanguage = output.groups[key];\n              break;\n          }\n        }\n      });\n    }\n\n    this.fetchContent();\n  }\n\n  async fetchContent() {\n    this.ensurePartner();\n\n    if (this.fetch && this.frbrExpressionUri && this.provider) {\n      const url = this.provider + '/p/' + this.partner + '/e/portion' + this.frbrExpressionUri;\n      try {\n        const resp = await fetch(url);\n        if (resp.ok) {\n          this.el.innerHTML = await resp.text();\n        }\n      } catch (error) {\n        // ignore\n      }\n    }\n  }\n\n  ensurePartner() {\n    if (!this.partner) {\n      this.partner = getPartner();\n    }\n  }\n\n  componentWillLoad() {\n    if (this.frbrExpressionUri) this.parseFrbrExpressionUri(this.frbrExpressionUri);\n  }\n}\n"],"mappings":";;;sFAAA,MAAMA,EAAgB,qu8DACtB,MAAAC,EAAeD,E,MCOFE,EAAU,M,6RAyC2B,M,qCAK7BC,C,CAMnB,OAAAC,GACEC,KAAKC,c,CAIP,sBAAAC,CAAuBC,GAErB,MAAMC,EACJ,2XACF,MAAMC,EAAS,IAAIC,OAAOF,EAAI,KAC9B,MAAMG,EAASF,EAAOG,KAAKL,GAC3B,GAAII,IAAM,MAANA,SAAM,SAANA,EAAQE,OAAQ,CAClBC,OAAOC,KAAKJ,EAAOE,QAAQG,SAASC,I,MAClC,IAAIC,EAAAP,EAAOE,UAAM,MAAAK,SAAA,SAAAA,EAAGD,GAAM,CACxB,OAAQA,GACN,IAAK,UACH,IAAKb,KAAKe,YAAaf,KAAKe,YAAcR,EAAOE,OAAOI,GACxD,MACF,IAAK,UACH,IAAKb,KAAKgB,SAAUhB,KAAKgB,SAAWT,EAAOE,OAAOI,GAClD,MACF,IAAK,UACH,IAAKb,KAAKiB,YAAajB,KAAKiB,YAAcV,EAAOE,OAAOI,GACxD,MACF,IAAK,QACH,IAAKb,KAAKkB,WAAYlB,KAAKkB,WAAaX,EAAOE,OAAOI,GACtD,MACF,IAAK,OACH,IAAKb,KAAKmB,SAAUnB,KAAKmB,SAAWZ,EAAOE,OAAOI,GAClD,MACF,IAAK,SACH,IAAKb,KAAKoB,WAAYpB,KAAKoB,WAAab,EAAOE,OAAOI,GACtD,MACF,IAAK,kBACH,IAAKb,KAAKqB,mBAAoB,CAC5BrB,KAAKqB,mBAAqBd,EAAOE,OAAOI,GAAKS,QAAQ,IAAK,IAAIA,QAAQ,IAAK,G,CAE7E,MACF,IAAK,WACH,IAAKtB,KAAKuB,aAAcvB,KAAKuB,aAAehB,EAAOE,OAAOI,GAC1D,M,KAMVb,KAAKC,c,CAGP,kBAAMA,GACJD,KAAKwB,gBAEL,GAAIxB,KAAKyB,OAASzB,KAAK0B,mBAAqB1B,KAAK2B,SAAU,CACzD,MAAMC,EAAM5B,KAAK2B,SAAW,MAAQ3B,KAAK6B,QAAU,aAAe7B,KAAK0B,kBACvE,IACE,MAAMI,QAAaL,MAAMG,GACzB,GAAIE,EAAKC,GAAI,CACX/B,KAAKgC,GAAGC,gBAAkBH,EAAKI,M,EAEjC,MAAOC,G,GAMb,aAAAX,GACE,IAAKxB,KAAK6B,QAAS,CACjB7B,KAAK6B,QAAUO,G,EAInB,iBAAAC,GACE,GAAIrC,KAAK0B,kBAAmB1B,KAAKE,uBAAuBF,KAAK0B,kB","ignoreList":[]}