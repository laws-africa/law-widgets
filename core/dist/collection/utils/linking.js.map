{"version":3,"file":"linking.js","sourceRoot":"","sources":["../../src/utils/linking.ts"],"names":[],"mappings":"AAAA,MAAM,UAAU,oBAAoB,CAAC,SAAkB,EAAE,QAA+B;IACtF,IAAI,QAAQ,EAAE,CAAC;QACb,OAAO,QAAQ,YAAY,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;IACtG,CAAC;IAED,2BAA2B;IAC3B,IAAI,EAAE,GAAuB,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;IAEjE,IAAI,CAAC,EAAE,EAAE,CAAC;QACR,4BAA4B;QAC5B,EAAE,GAAG,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;IAC/D,CAAC;IAED,OAAO,EAAE,CAAC;AACZ,CAAC;AAMD;;GAEG;AACH,MAAM,OAAO,gBAAgB;IAO3B,YACE,SAAkB,EAClB,QAA0C,EAC1C,QAAyC;QAEzC,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QAEjC,4DAA4D;QAC5D,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,gBAAgB,EAAE,CAAC;YAC3C,IAAI,CAAC,QAAQ,GAAG,IAAI,gBAAgB,CAAC,GAAG,EAAE;gBACxC,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC1B,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;QAC1D,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACvB,CAAC;IACH,CAAC;IAED,UAAU;QACR,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED,WAAW;QACT,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YAClB,OAAO,IAAI,CAAC,QAAQ,YAAY,WAAW;gBACzC,CAAC,CAAC,IAAI,CAAC,QAAQ;gBACf,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAChE,CAAC;QAED,2BAA2B;QAC3B,IAAI,EAAE,GAAuB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAEtE,IAAI,CAAC,EAAE,EAAE,CAAC;YACR,4BAA4B;YAC5B,EAAE,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;QACpE,CAAC;QAED,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,+BAA+B;IAC/B,gBAAgB;QACd,IAAI,IAAI,CAAC,QAAQ;YAAE,IAAI,CAAC,QAAQ,EAAE,CAAC;IACrC,CAAC;CACF","sourcesContent":["export function getAkomaNtosoElement(component: Element, selector?: string | HTMLElement): HTMLElement | null {\n  if (selector) {\n    return selector instanceof HTMLElement ? selector : component.ownerDocument.querySelector(selector);\n  }\n\n  // try the nearest ancestor\n  let el: HTMLElement | null = component.closest('la-akoma-ntoso');\n\n  if (!el) {\n    // try the first on the page\n    el = component.ownerDocument.querySelector('la-akoma-ntoso');\n  }\n\n  return el;\n}\n\ninterface TargetDomChangedCallback {\n  (): void;\n}\n\n/**\n * Helper class that finds an Akoma Ntoso target element on the page, and monitors it for changes.\n */\nexport class AkomaNtosoTarget {\n  selector: string | HTMLElement | undefined;\n  component: Element;\n  target: HTMLElement | null;\n  observer: MutationObserver | null;\n  callback: TargetDomChangedCallback | null;\n\n  constructor(\n    component: Element,\n    selector: string | HTMLElement | undefined,\n    callback: TargetDomChangedCallback | null\n  ) {\n    this.component = component;\n    this.selector = selector;\n    this.callback = callback;\n    this.target = this.findElement();\n\n    // setup a watcher to callback if the target content changes\n    if (this.target && window.MutationObserver) {\n      this.observer = new MutationObserver(() => {\n        this.targetDomChanged();\n      });\n      this.observer.observe(this.target, { childList: true });\n    } else {\n      this.observer = null;\n    }\n  }\n\n  getElement(): HTMLElement | null {\n    return this.target;\n  }\n\n  findElement(): HTMLElement | null {\n    if (this.selector) {\n      return this.selector instanceof HTMLElement\n        ? this.selector\n        : this.component.ownerDocument.querySelector(this.selector);\n    }\n\n    // try the nearest ancestor\n    let el: HTMLElement | null = this.component.closest('la-akoma-ntoso');\n\n    if (!el) {\n      // try the first on the page\n      el = this.component.ownerDocument.querySelector('la-akoma-ntoso');\n    }\n\n    return el;\n  }\n\n  /** The target's dom changed */\n  targetDomChanged() {\n    if (this.callback) this.callback();\n  }\n}\n"]}